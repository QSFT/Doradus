~~~~~~~~~~~~~~
~ XML format ~
~~~~~~~~~~~~~~

~~~~~~~~~~~~~~~~~~~~~~
~ Create application ~
~~~~~~~~~~~~~~~~~~~~~~
*** Request
    POST /Application/_shards/shard
*** Response: 
    200 OK

~~~~~~~~~~~~~~~~~~~~
~ Table of Content ~
~~~~~~~~~~~~~~~~~~~~
*** Request
    GET /Application/Messages/_query?q=*&f=_all&shards=shard
*** Response: xml
    200 OK
    <results>
        <totalobjects>6</totalobjects>
        <docs>
            <doc>
                <field name="Message">Message 1</field>
                <field name="_ID">1001</field>
                <field name="_shard">shard</field>
                <field name="Participants">
                    <doc>
                        <field name="Department">Support</field>
                        <field name="IsSender">True</field>
                        <field name="Office">Kanata</field>
                        <field name="_ID">2001</field>
                    </doc>
                    <doc>
                        <field name="Department">Support</field>
                        <field name="IsSender">False</field>
                        <field name="Office">Kanata</field>
                        <field name="_ID">2002</field>
                    </doc>
                </field>
            </doc>
            <doc>
                <field name="Message">Message 2</field>
                <field name="_ID">1002</field>
                <field name="_shard">shard</field>
                <field name="Participants">
                    <doc>
                        <field name="Department">Support</field>
                        <field name="IsSender">True</field>
                        <field name="Office">Ohio</field>
                        <field name="_ID">2003</field>
                    </doc>
                    <doc>
                        <field name="Department">CEO</field>
                        <field name="IsSender">False</field>
                        <field name="Office">Aliso</field>
                        <field name="_ID">2004</field>
                    </doc>
                </field>
            </doc>
            <doc>
                <field name="Message">Message 3</field>
                <field name="_ID">1003</field>
                <field name="_shard">shard</field>
                <field name="Participants">
                    <doc>
                        <field name="Department">CEO</field>
                        <field name="IsSender">True</field>
                        <field name="Office">Kanata</field>
                        <field name="_ID">2005</field>
                    </doc>
                    <doc>
                        <field name="Department">STO</field>
                        <field name="IsSender">False</field>
                        <field name="Office">Kanata</field>
                        <field name="_ID">2006</field>
                    </doc>
                </field>
            </doc>
            <doc>
                <field name="Message">Message 4</field>
                <field name="_ID">1004</field>
                <field name="_shard">shard</field>
                <field name="Participants">
                    <doc>
                        <field name="Department">Support</field>
                        <field name="IsSender">True</field>
                        <field name="Office">Kanata</field>
                        <field name="_ID">2007</field>
                    </doc>
                    <doc>
                        <field name="Department">Support</field>
                        <field name="IsSender">False</field>
                        <field name="Office">Kanata</field>
                        <field name="_ID">2008</field>
                    </doc>
                </field>
            </doc>
            <doc>
                <field name="Message">Message 5</field>
                <field name="_ID">1005</field>
                <field name="_shard">shard</field>
                <field name="Participants">
                    <doc>
                        <field name="Department">Support</field>
                        <field name="IsSender">True</field>
                        <field name="Office">Ohio</field>
                        <field name="_ID">2009</field>
                    </doc>
                    <doc>
                        <field name="Department">CEO</field>
                        <field name="IsSender">False</field>
                        <field name="Office">Aliso</field>
                        <field name="_ID">2010</field>
                    </doc>
                </field>
            </doc>
            <doc>
                <field name="Message">Message 6</field>
                <field name="_ID">1006</field>
                <field name="_shard">shard</field>
                <field name="Participants">
                    <doc>
                        <field name="Department">CEO</field>
                        <field name="IsSender">False</field>
                        <field name="Office">Kanata</field>
                        <field name="_ID">2011</field>
                    </doc>
                    <doc>
                        <field name="Department">STO</field>
                        <field name="IsSender">False</field>
                        <field name="Office">Kanata</field>
                        <field name="_ID">2012</field>
                    </doc>
                </field>
            </doc>
        </docs>
    </results>
*** Response: json
    200 OK
    {
       "results":{
          "totalobjects":"6",
          "docs":[
             {
                "doc":{
                   "Message":"Message 1",
                   "_ID":"1001",
                   "_shard":"shard",
                   "Participants":[
                      {
                         "doc":{
                            "Department":"Support",
                            "IsSender":"True",
                            "Office":"Kanata",
                            "_ID":"2001"
                         }
                      },
                      {
                         "doc":{
                            "Department":"Support",
                            "IsSender":"False",
                            "Office":"Kanata",
                            "_ID":"2002"
                         }
                      }
                   ]
                }
             },
             {
                "doc":{
                   "Message":"Message 2",
                   "_ID":"1002",
                   "_shard":"shard",
                   "Participants":[
                      {
                         "doc":{
                            "Department":"Support",
                            "IsSender":"True",
                            "Office":"Ohio",
                            "_ID":"2003"
                         }
                      },
                      {
                         "doc":{
                            "Department":"CEO",
                            "IsSender":"False",
                            "Office":"Aliso",
                            "_ID":"2004"
                         }
                      }
                   ]
                }
             },
             {
                "doc":{
                   "Message":"Message 3",
                   "_ID":"1003",
                   "_shard":"shard",
                   "Participants":[
                      {
                         "doc":{
                            "Department":"CEO",
                            "IsSender":"True",
                            "Office":"Kanata",
                            "_ID":"2005"
                         }
                      },
                      {
                         "doc":{
                            "Department":"STO",
                            "IsSender":"False",
                            "Office":"Kanata",
                            "_ID":"2006"
                         }
                      }
                   ]
                }
             },
             {
                "doc":{
                   "Message":"Message 4",
                   "_ID":"1004",
                   "_shard":"shard",
                   "Participants":[
                      {
                         "doc":{
                            "Department":"Support",
                            "IsSender":"True",
                            "Office":"Kanata",
                            "_ID":"2007"
                         }
                      },
                      {
                         "doc":{
                            "Department":"Support",
                            "IsSender":"False",
                            "Office":"Kanata",
                            "_ID":"2008"
                         }
                      }
                   ]
                }
             },
             {
                "doc":{
                   "Message":"Message 5",
                   "_ID":"1005",
                   "_shard":"shard",
                   "Participants":[
                      {
                         "doc":{
                            "Department":"Support",
                            "IsSender":"True",
                            "Office":"Ohio",
                            "_ID":"2009"
                         }
                      },
                      {
                         "doc":{
                            "Department":"CEO",
                            "IsSender":"False",
                            "Office":"Aliso",
                            "_ID":"2010"
                         }
                      }
                   ]
                }
             },
             {
                "doc":{
                   "Message":"Message 6",
                   "_ID":"1006",
                   "_shard":"shard",
                   "Participants":[
                      {
                         "doc":{
                            "Department":"CEO",
                            "IsSender":"False",
                            "Office":"Kanata",
                            "_ID":"2011"
                         }
                      },
                      {
                         "doc":{
                            "Department":"STO",
                            "IsSender":"False",
                            "Office":"Kanata",
                            "_ID":"2012"
                         }
                      }
                   ]
                }
             }
          ]
       }
    }

*** Request
    GET /Application/Participants/_query?q=*&f=_all&shards=shard
*** Response: xml
    200 OK
    <results>
        <totalobjects>12</totalobjects>
        <docs>
            <doc>
                <field name="Department">Support</field>
                <field name="IsSender">True</field>
                <field name="Office">Kanata</field>
                <field name="_ID">2001</field>
                <field name="_shard">shard</field>
                <field name="Sender1">
                    <doc>
                        <field name="Message">Message 1</field>
                        <field name="_ID">1001</field>
                    </doc>
                </field>
            </doc>
            <doc>
                <field name="Department">Support</field>
                <field name="IsSender">False</field>
                <field name="Office">Kanata</field>
                <field name="_ID">2002</field>
                <field name="_shard">shard</field>
                <field name="Sender1">
                    <doc>
                        <field name="Message">Message 1</field>
                        <field name="_ID">1001</field>
                    </doc>
                </field>
            </doc>
            <doc>
                <field name="Department">Support</field>
                <field name="IsSender">True</field>
                <field name="Office">Ohio</field>
                <field name="_ID">2003</field>
                <field name="_shard">shard</field>
                <field name="Sender1">
                    <doc>
                        <field name="Message">Message 2</field>
                        <field name="_ID">1002</field>
                    </doc>
                </field>
            </doc>
            <doc>
                <field name="Department">CEO</field>
                <field name="IsSender">False</field>
                <field name="Office">Aliso</field>
                <field name="_ID">2004</field>
                <field name="_shard">shard</field>
                <field name="Sender1">
                    <doc>
                        <field name="Message">Message 2</field>
                        <field name="_ID">1002</field>
                    </doc>
                </field>
            </doc>
            <doc>
                <field name="Department">CEO</field>
                <field name="IsSender">True</field>
                <field name="Office">Kanata</field>
                <field name="_ID">2005</field>
                <field name="_shard">shard</field>
                <field name="Sender1">
                    <doc>
                        <field name="Message">Message 3</field>
                        <field name="_ID">1003</field>
                    </doc>
                </field>
            </doc>
            <doc>
                <field name="Department">STO</field>
                <field name="IsSender">False</field>
                <field name="Office">Kanata</field>
                <field name="_ID">2006</field>
                <field name="_shard">shard</field>
                <field name="Sender1">
                    <doc>
                        <field name="Message">Message 3</field>
                        <field name="_ID">1003</field>
                    </doc>
                </field>
            </doc>
            <doc>
                <field name="Department">Support</field>
                <field name="IsSender">True</field>
                <field name="Office">Kanata</field>
                <field name="_ID">2007</field>
                <field name="_shard">shard</field>
                <field name="Sender1">
                    <doc>
                        <field name="Message">Message 4</field>
                        <field name="_ID">1004</field>
                    </doc>
                </field>
            </doc>
            <doc>
                <field name="Department">Support</field>
                <field name="IsSender">False</field>
                <field name="Office">Kanata</field>
                <field name="_ID">2008</field>
                <field name="_shard">shard</field>
                <field name="Sender1">
                    <doc>
                        <field name="Message">Message 4</field>
                        <field name="_ID">1004</field>
                    </doc>
                </field>
            </doc>
            <doc>
                <field name="Department">Support</field>
                <field name="IsSender">True</field>
                <field name="Office">Ohio</field>
                <field name="_ID">2009</field>
                <field name="_shard">shard</field>
                <field name="Sender1">
                    <doc>
                        <field name="Message">Message 5</field>
                        <field name="_ID">1005</field>
                    </doc>
                </field>
            </doc>
            <doc>
                <field name="Department">CEO</field>
                <field name="IsSender">False</field>
                <field name="Office">Aliso</field>
                <field name="_ID">2010</field>
                <field name="_shard">shard</field>
                <field name="Sender1">
                    <doc>
                        <field name="Message">Message 5</field>
                        <field name="_ID">1005</field>
                    </doc>
                </field>
            </doc>
            <doc>
                <field name="Department">CEO</field>
                <field name="IsSender">False</field>
                <field name="Office">Kanata</field>
                <field name="_ID">2011</field>
                <field name="_shard">shard</field>
                <field name="Sender1">
                    <doc>
                        <field name="Message">Message 6</field>
                        <field name="_ID">1006</field>
                    </doc>
                </field>
            </doc>
            <doc>
                <field name="Department">STO</field>
                <field name="IsSender">False</field>
                <field name="Office">Kanata</field>
                <field name="_ID">2012</field>
                <field name="_shard">shard</field>
                <field name="Sender1">
                    <doc>
                        <field name="Message">Message 6</field>
                        <field name="_ID">1006</field>
                    </doc>
                </field>
            </doc>
        </docs>
    </results>
*** Response: json
    200 OK
    {
       "results":{
          "totalobjects":"12",
          "docs":[
             {
                "doc":{
                   "Department":"Support",
                   "IsSender":"True",
                   "Office":"Kanata",
                   "_ID":"2001",
                   "_shard":"shard",
                   "Sender1":[
                      {
                         "doc":{
                            "Message":"Message 1",
                            "_ID":"1001"
                         }
                      }
                   ]
                }
             },
             {
                "doc":{
                   "Department":"Support",
                   "IsSender":"False",
                   "Office":"Kanata",
                   "_ID":"2002",
                   "_shard":"shard",
                   "Sender1":[
                      {
                         "doc":{
                            "Message":"Message 1",
                            "_ID":"1001"
                         }
                      }
                   ]
                }
             },
             {
                "doc":{
                   "Department":"Support",
                   "IsSender":"True",
                   "Office":"Ohio",
                   "_ID":"2003",
                   "_shard":"shard",
                   "Sender1":[
                      {
                         "doc":{
                            "Message":"Message 2",
                            "_ID":"1002"
                         }
                      }
                   ]
                }
             },
             {
                "doc":{
                   "Department":"CEO",
                   "IsSender":"False",
                   "Office":"Aliso",
                   "_ID":"2004",
                   "_shard":"shard",
                   "Sender1":[
                      {
                         "doc":{
                            "Message":"Message 2",
                            "_ID":"1002"
                         }
                      }
                   ]
                }
             },
             {
                "doc":{
                   "Department":"CEO",
                   "IsSender":"True",
                   "Office":"Kanata",
                   "_ID":"2005",
                   "_shard":"shard",
                   "Sender1":[
                      {
                         "doc":{
                            "Message":"Message 3",
                            "_ID":"1003"
                         }
                      }
                   ]
                }
             },
             {
                "doc":{
                   "Department":"STO",
                   "IsSender":"False",
                   "Office":"Kanata",
                   "_ID":"2006",
                   "_shard":"shard",
                   "Sender1":[
                      {
                         "doc":{
                            "Message":"Message 3",
                            "_ID":"1003"
                         }
                      }
                   ]
                }
             },
             {
                "doc":{
                   "Department":"Support",
                   "IsSender":"True",
                   "Office":"Kanata",
                   "_ID":"2007",
                   "_shard":"shard",
                   "Sender1":[
                      {
                         "doc":{
                            "Message":"Message 4",
                            "_ID":"1004"
                         }
                      }
                   ]
                }
             },
             {
                "doc":{
                   "Department":"Support",
                   "IsSender":"False",
                   "Office":"Kanata",
                   "_ID":"2008",
                   "_shard":"shard",
                   "Sender1":[
                      {
                         "doc":{
                            "Message":"Message 4",
                            "_ID":"1004"
                         }
                      }
                   ]
                }
             },
             {
                "doc":{
                   "Department":"Support",
                   "IsSender":"True",
                   "Office":"Ohio",
                   "_ID":"2009",
                   "_shard":"shard",
                   "Sender1":[
                      {
                         "doc":{
                            "Message":"Message 5",
                            "_ID":"1005"
                         }
                      }
                   ]
                }
             },
             {
                "doc":{
                   "Department":"CEO",
                   "IsSender":"False",
                   "Office":"Aliso",
                   "_ID":"2010",
                   "_shard":"shard",
                   "Sender1":[
                      {
                         "doc":{
                            "Message":"Message 5",
                            "_ID":"1005"
                         }
                      }
                   ]
                }
             },
             {
                "doc":{
                   "Department":"CEO",
                   "IsSender":"False",
                   "Office":"Kanata",
                   "_ID":"2011",
                   "_shard":"shard",
                   "Sender1":[
                      {
                         "doc":{
                            "Message":"Message 6",
                            "_ID":"1006"
                         }
                      }
                   ]
                }
             },
             {
                "doc":{
                   "Department":"STO",
                   "IsSender":"False",
                   "Office":"Kanata",
                   "_ID":"2012",
                   "_shard":"shard",
                   "Sender1":[
                      {
                         "doc":{
                            "Message":"Message 6",
                            "_ID":"1006"
                         }
                      }
                   ]
                }
             }
          ]
       }
    }

~~~~~~~~~~~~~~~~~~~~~~~~~~~
~ Test for pair parameter ~
~~~~~~~~~~~~~~~~~~~~~~~~~~~
*** Request
    GET /Application/Messages/_aggregate?m=COUNT(Message)&q=_pair.first.Office=Kanata&f=_pair.second.Department&pair=Participants.WHERE(IsSender=true),Participants.WHERE(IsSender=false)&shards=shard
*** Response: xml
    200 OK
    <results>
        <aggregate group="_pair.second.Department" metric="COUNT(Message)" query="_pair.first.Office=Kanata"/>
        <totalobjects>4</totalobjects>
        <summary>4</summary>
        <totalgroups>4</totalgroups>
        <groups>
            <group>
                <metric>1</metric>
                <field name="_pair.second.Department">(null)</field>
            </group>
            <group>
                <metric>1</metric>
                <field name="_pair.second.Department">CEO</field>
            </group>
            <group>
                <metric>1</metric>
                <field name="_pair.second.Department">STO</field>
            </group>
            <group>
                <metric>2</metric>
                <field name="_pair.second.Department">Support</field>
            </group>
        </groups>
    </results>
*** Response: json
    200 OK
    {
       "results":{
          "aggregate":{
             "metric":"COUNT(Message)",
             "query":"_pair.first.Office=Kanata",
             "group":"_pair.second.Department"
          },
          "totalobjects":"4",
          "summary":"4",
          "totalgroups":"4",
          "groups":[
             {
                "group":{
                   "metric":"1",
                   "field":{
                      "_pair.second.Department":"(null)"
                   }
                }
             },
             {
                "group":{
                   "metric":"1",
                   "field":{
                      "_pair.second.Department":"CEO"
                   }
                }
             },
             {
                "group":{
                   "metric":"1",
                   "field":{
                      "_pair.second.Department":"STO"
                   }
                }
             },
             {
                "group":{
                   "metric":"2",
                   "field":{
                      "_pair.second.Department":"Support"
                   }
                }
             }
          ]
       }
    }

*** Request
    DELETE /_applications/Application/ApplicationKey
*** Response: 
    200 OK

~~~~~~~~~~~~~~~
~ JSON format ~
~~~~~~~~~~~~~~~

~~~~~~~~~~~~~~~~~~~~~~
~ Create application ~
~~~~~~~~~~~~~~~~~~~~~~
*** Request
    POST /Application/_shards/shard
*** Response: 
    200 OK

~~~~~~~~~~~~~~~~~~~~
~ Table of Content ~
~~~~~~~~~~~~~~~~~~~~
*** Request
    GET /Application/Messages/_query?q=*&f=_all&shards=shard
*** Response: xml
    200 OK
    <results>
        <totalobjects>6</totalobjects>
        <docs>
            <doc>
                <field name="Message">Message 1</field>
                <field name="_ID">1001</field>
                <field name="_shard">shard</field>
                <field name="Participants">
                    <doc>
                        <field name="Department">Support</field>
                        <field name="IsSender">True</field>
                        <field name="Office">Kanata</field>
                        <field name="_ID">2001</field>
                    </doc>
                    <doc>
                        <field name="Department">Support</field>
                        <field name="IsSender">False</field>
                        <field name="Office">Kanata</field>
                        <field name="_ID">2002</field>
                    </doc>
                </field>
            </doc>
            <doc>
                <field name="Message">Message 2</field>
                <field name="_ID">1002</field>
                <field name="_shard">shard</field>
                <field name="Participants">
                    <doc>
                        <field name="Department">Support</field>
                        <field name="IsSender">True</field>
                        <field name="Office">Ohio</field>
                        <field name="_ID">2003</field>
                    </doc>
                    <doc>
                        <field name="Department">CEO</field>
                        <field name="IsSender">False</field>
                        <field name="Office">Aliso</field>
                        <field name="_ID">2004</field>
                    </doc>
                </field>
            </doc>
            <doc>
                <field name="Message">Message 3</field>
                <field name="_ID">1003</field>
                <field name="_shard">shard</field>
                <field name="Participants">
                    <doc>
                        <field name="Department">CEO</field>
                        <field name="IsSender">True</field>
                        <field name="Office">Kanata</field>
                        <field name="_ID">2005</field>
                    </doc>
                    <doc>
                        <field name="Department">STO</field>
                        <field name="IsSender">False</field>
                        <field name="Office">Kanata</field>
                        <field name="_ID">2006</field>
                    </doc>
                </field>
            </doc>
            <doc>
                <field name="Message">Message 4</field>
                <field name="_ID">1004</field>
                <field name="_shard">shard</field>
                <field name="Participants">
                    <doc>
                        <field name="Department">Support</field>
                        <field name="IsSender">True</field>
                        <field name="Office">Kanata</field>
                        <field name="_ID">2007</field>
                    </doc>
                    <doc>
                        <field name="Department">Support</field>
                        <field name="IsSender">False</field>
                        <field name="Office">Kanata</field>
                        <field name="_ID">2008</field>
                    </doc>
                </field>
            </doc>
            <doc>
                <field name="Message">Message 5</field>
                <field name="_ID">1005</field>
                <field name="_shard">shard</field>
                <field name="Participants">
                    <doc>
                        <field name="Department">Support</field>
                        <field name="IsSender">True</field>
                        <field name="Office">Ohio</field>
                        <field name="_ID">2009</field>
                    </doc>
                    <doc>
                        <field name="Department">CEO</field>
                        <field name="IsSender">False</field>
                        <field name="Office">Aliso</field>
                        <field name="_ID">2010</field>
                    </doc>
                </field>
            </doc>
            <doc>
                <field name="Message">Message 6</field>
                <field name="_ID">1006</field>
                <field name="_shard">shard</field>
                <field name="Participants">
                    <doc>
                        <field name="Department">CEO</field>
                        <field name="IsSender">False</field>
                        <field name="Office">Kanata</field>
                        <field name="_ID">2011</field>
                    </doc>
                    <doc>
                        <field name="Department">STO</field>
                        <field name="IsSender">False</field>
                        <field name="Office">Kanata</field>
                        <field name="_ID">2012</field>
                    </doc>
                </field>
            </doc>
        </docs>
    </results>
*** Response: json
    200 OK
    {
       "results":{
          "totalobjects":"6",
          "docs":[
             {
                "doc":{
                   "Message":"Message 1",
                   "_ID":"1001",
                   "_shard":"shard",
                   "Participants":[
                      {
                         "doc":{
                            "Department":"Support",
                            "IsSender":"True",
                            "Office":"Kanata",
                            "_ID":"2001"
                         }
                      },
                      {
                         "doc":{
                            "Department":"Support",
                            "IsSender":"False",
                            "Office":"Kanata",
                            "_ID":"2002"
                         }
                      }
                   ]
                }
             },
             {
                "doc":{
                   "Message":"Message 2",
                   "_ID":"1002",
                   "_shard":"shard",
                   "Participants":[
                      {
                         "doc":{
                            "Department":"Support",
                            "IsSender":"True",
                            "Office":"Ohio",
                            "_ID":"2003"
                         }
                      },
                      {
                         "doc":{
                            "Department":"CEO",
                            "IsSender":"False",
                            "Office":"Aliso",
                            "_ID":"2004"
                         }
                      }
                   ]
                }
             },
             {
                "doc":{
                   "Message":"Message 3",
                   "_ID":"1003",
                   "_shard":"shard",
                   "Participants":[
                      {
                         "doc":{
                            "Department":"CEO",
                            "IsSender":"True",
                            "Office":"Kanata",
                            "_ID":"2005"
                         }
                      },
                      {
                         "doc":{
                            "Department":"STO",
                            "IsSender":"False",
                            "Office":"Kanata",
                            "_ID":"2006"
                         }
                      }
                   ]
                }
             },
             {
                "doc":{
                   "Message":"Message 4",
                   "_ID":"1004",
                   "_shard":"shard",
                   "Participants":[
                      {
                         "doc":{
                            "Department":"Support",
                            "IsSender":"True",
                            "Office":"Kanata",
                            "_ID":"2007"
                         }
                      },
                      {
                         "doc":{
                            "Department":"Support",
                            "IsSender":"False",
                            "Office":"Kanata",
                            "_ID":"2008"
                         }
                      }
                   ]
                }
             },
             {
                "doc":{
                   "Message":"Message 5",
                   "_ID":"1005",
                   "_shard":"shard",
                   "Participants":[
                      {
                         "doc":{
                            "Department":"Support",
                            "IsSender":"True",
                            "Office":"Ohio",
                            "_ID":"2009"
                         }
                      },
                      {
                         "doc":{
                            "Department":"CEO",
                            "IsSender":"False",
                            "Office":"Aliso",
                            "_ID":"2010"
                         }
                      }
                   ]
                }
             },
             {
                "doc":{
                   "Message":"Message 6",
                   "_ID":"1006",
                   "_shard":"shard",
                   "Participants":[
                      {
                         "doc":{
                            "Department":"CEO",
                            "IsSender":"False",
                            "Office":"Kanata",
                            "_ID":"2011"
                         }
                      },
                      {
                         "doc":{
                            "Department":"STO",
                            "IsSender":"False",
                            "Office":"Kanata",
                            "_ID":"2012"
                         }
                      }
                   ]
                }
             }
          ]
       }
    }

*** Request
    GET /Application/Participants/_query?q=*&f=_all&shards=shard
*** Response: xml
    200 OK
    <results>
        <totalobjects>12</totalobjects>
        <docs>
            <doc>
                <field name="Department">Support</field>
                <field name="IsSender">True</field>
                <field name="Office">Kanata</field>
                <field name="_ID">2001</field>
                <field name="_shard">shard</field>
                <field name="Sender1">
                    <doc>
                        <field name="Message">Message 1</field>
                        <field name="_ID">1001</field>
                    </doc>
                </field>
            </doc>
            <doc>
                <field name="Department">Support</field>
                <field name="IsSender">False</field>
                <field name="Office">Kanata</field>
                <field name="_ID">2002</field>
                <field name="_shard">shard</field>
                <field name="Sender1">
                    <doc>
                        <field name="Message">Message 1</field>
                        <field name="_ID">1001</field>
                    </doc>
                </field>
            </doc>
            <doc>
                <field name="Department">Support</field>
                <field name="IsSender">True</field>
                <field name="Office">Ohio</field>
                <field name="_ID">2003</field>
                <field name="_shard">shard</field>
                <field name="Sender1">
                    <doc>
                        <field name="Message">Message 2</field>
                        <field name="_ID">1002</field>
                    </doc>
                </field>
            </doc>
            <doc>
                <field name="Department">CEO</field>
                <field name="IsSender">False</field>
                <field name="Office">Aliso</field>
                <field name="_ID">2004</field>
                <field name="_shard">shard</field>
                <field name="Sender1">
                    <doc>
                        <field name="Message">Message 2</field>
                        <field name="_ID">1002</field>
                    </doc>
                </field>
            </doc>
            <doc>
                <field name="Department">CEO</field>
                <field name="IsSender">True</field>
                <field name="Office">Kanata</field>
                <field name="_ID">2005</field>
                <field name="_shard">shard</field>
                <field name="Sender1">
                    <doc>
                        <field name="Message">Message 3</field>
                        <field name="_ID">1003</field>
                    </doc>
                </field>
            </doc>
            <doc>
                <field name="Department">STO</field>
                <field name="IsSender">False</field>
                <field name="Office">Kanata</field>
                <field name="_ID">2006</field>
                <field name="_shard">shard</field>
                <field name="Sender1">
                    <doc>
                        <field name="Message">Message 3</field>
                        <field name="_ID">1003</field>
                    </doc>
                </field>
            </doc>
            <doc>
                <field name="Department">Support</field>
                <field name="IsSender">True</field>
                <field name="Office">Kanata</field>
                <field name="_ID">2007</field>
                <field name="_shard">shard</field>
                <field name="Sender1">
                    <doc>
                        <field name="Message">Message 4</field>
                        <field name="_ID">1004</field>
                    </doc>
                </field>
            </doc>
            <doc>
                <field name="Department">Support</field>
                <field name="IsSender">False</field>
                <field name="Office">Kanata</field>
                <field name="_ID">2008</field>
                <field name="_shard">shard</field>
                <field name="Sender1">
                    <doc>
                        <field name="Message">Message 4</field>
                        <field name="_ID">1004</field>
                    </doc>
                </field>
            </doc>
            <doc>
                <field name="Department">Support</field>
                <field name="IsSender">True</field>
                <field name="Office">Ohio</field>
                <field name="_ID">2009</field>
                <field name="_shard">shard</field>
                <field name="Sender1">
                    <doc>
                        <field name="Message">Message 5</field>
                        <field name="_ID">1005</field>
                    </doc>
                </field>
            </doc>
            <doc>
                <field name="Department">CEO</field>
                <field name="IsSender">False</field>
                <field name="Office">Aliso</field>
                <field name="_ID">2010</field>
                <field name="_shard">shard</field>
                <field name="Sender1">
                    <doc>
                        <field name="Message">Message 5</field>
                        <field name="_ID">1005</field>
                    </doc>
                </field>
            </doc>
            <doc>
                <field name="Department">CEO</field>
                <field name="IsSender">False</field>
                <field name="Office">Kanata</field>
                <field name="_ID">2011</field>
                <field name="_shard">shard</field>
                <field name="Sender1">
                    <doc>
                        <field name="Message">Message 6</field>
                        <field name="_ID">1006</field>
                    </doc>
                </field>
            </doc>
            <doc>
                <field name="Department">STO</field>
                <field name="IsSender">False</field>
                <field name="Office">Kanata</field>
                <field name="_ID">2012</field>
                <field name="_shard">shard</field>
                <field name="Sender1">
                    <doc>
                        <field name="Message">Message 6</field>
                        <field name="_ID">1006</field>
                    </doc>
                </field>
            </doc>
        </docs>
    </results>
*** Response: json
    200 OK
    {
       "results":{
          "totalobjects":"12",
          "docs":[
             {
                "doc":{
                   "Department":"Support",
                   "IsSender":"True",
                   "Office":"Kanata",
                   "_ID":"2001",
                   "_shard":"shard",
                   "Sender1":[
                      {
                         "doc":{
                            "Message":"Message 1",
                            "_ID":"1001"
                         }
                      }
                   ]
                }
             },
             {
                "doc":{
                   "Department":"Support",
                   "IsSender":"False",
                   "Office":"Kanata",
                   "_ID":"2002",
                   "_shard":"shard",
                   "Sender1":[
                      {
                         "doc":{
                            "Message":"Message 1",
                            "_ID":"1001"
                         }
                      }
                   ]
                }
             },
             {
                "doc":{
                   "Department":"Support",
                   "IsSender":"True",
                   "Office":"Ohio",
                   "_ID":"2003",
                   "_shard":"shard",
                   "Sender1":[
                      {
                         "doc":{
                            "Message":"Message 2",
                            "_ID":"1002"
                         }
                      }
                   ]
                }
             },
             {
                "doc":{
                   "Department":"CEO",
                   "IsSender":"False",
                   "Office":"Aliso",
                   "_ID":"2004",
                   "_shard":"shard",
                   "Sender1":[
                      {
                         "doc":{
                            "Message":"Message 2",
                            "_ID":"1002"
                         }
                      }
                   ]
                }
             },
             {
                "doc":{
                   "Department":"CEO",
                   "IsSender":"True",
                   "Office":"Kanata",
                   "_ID":"2005",
                   "_shard":"shard",
                   "Sender1":[
                      {
                         "doc":{
                            "Message":"Message 3",
                            "_ID":"1003"
                         }
                      }
                   ]
                }
             },
             {
                "doc":{
                   "Department":"STO",
                   "IsSender":"False",
                   "Office":"Kanata",
                   "_ID":"2006",
                   "_shard":"shard",
                   "Sender1":[
                      {
                         "doc":{
                            "Message":"Message 3",
                            "_ID":"1003"
                         }
                      }
                   ]
                }
             },
             {
                "doc":{
                   "Department":"Support",
                   "IsSender":"True",
                   "Office":"Kanata",
                   "_ID":"2007",
                   "_shard":"shard",
                   "Sender1":[
                      {
                         "doc":{
                            "Message":"Message 4",
                            "_ID":"1004"
                         }
                      }
                   ]
                }
             },
             {
                "doc":{
                   "Department":"Support",
                   "IsSender":"False",
                   "Office":"Kanata",
                   "_ID":"2008",
                   "_shard":"shard",
                   "Sender1":[
                      {
                         "doc":{
                            "Message":"Message 4",
                            "_ID":"1004"
                         }
                      }
                   ]
                }
             },
             {
                "doc":{
                   "Department":"Support",
                   "IsSender":"True",
                   "Office":"Ohio",
                   "_ID":"2009",
                   "_shard":"shard",
                   "Sender1":[
                      {
                         "doc":{
                            "Message":"Message 5",
                            "_ID":"1005"
                         }
                      }
                   ]
                }
             },
             {
                "doc":{
                   "Department":"CEO",
                   "IsSender":"False",
                   "Office":"Aliso",
                   "_ID":"2010",
                   "_shard":"shard",
                   "Sender1":[
                      {
                         "doc":{
                            "Message":"Message 5",
                            "_ID":"1005"
                         }
                      }
                   ]
                }
             },
             {
                "doc":{
                   "Department":"CEO",
                   "IsSender":"False",
                   "Office":"Kanata",
                   "_ID":"2011",
                   "_shard":"shard",
                   "Sender1":[
                      {
                         "doc":{
                            "Message":"Message 6",
                            "_ID":"1006"
                         }
                      }
                   ]
                }
             },
             {
                "doc":{
                   "Department":"STO",
                   "IsSender":"False",
                   "Office":"Kanata",
                   "_ID":"2012",
                   "_shard":"shard",
                   "Sender1":[
                      {
                         "doc":{
                            "Message":"Message 6",
                            "_ID":"1006"
                         }
                      }
                   ]
                }
             }
          ]
       }
    }

~~~~~~~~~~~~~~~~~~~~~~~~~~~
~ Test for pair parameter ~
~~~~~~~~~~~~~~~~~~~~~~~~~~~
*** Request
    GET /Application/Messages/_aggregate?m=COUNT(Message)&q=_pair.first.Office=Kanata&f=_pair.second.Department&pair=Participants.WHERE(IsSender=true),Participants.WHERE(IsSender=false)&shards=shard
*** Response: xml
    200 OK
    <results>
        <aggregate group="_pair.second.Department" metric="COUNT(Message)" query="_pair.first.Office=Kanata"/>
        <totalobjects>4</totalobjects>
        <summary>4</summary>
        <totalgroups>4</totalgroups>
        <groups>
            <group>
                <metric>1</metric>
                <field name="_pair.second.Department">(null)</field>
            </group>
            <group>
                <metric>1</metric>
                <field name="_pair.second.Department">CEO</field>
            </group>
            <group>
                <metric>1</metric>
                <field name="_pair.second.Department">STO</field>
            </group>
            <group>
                <metric>2</metric>
                <field name="_pair.second.Department">Support</field>
            </group>
        </groups>
    </results>
*** Response: json
    200 OK
    {
       "results":{
          "aggregate":{
             "metric":"COUNT(Message)",
             "query":"_pair.first.Office=Kanata",
             "group":"_pair.second.Department"
          },
          "totalobjects":"4",
          "summary":"4",
          "totalgroups":"4",
          "groups":[
             {
                "group":{
                   "metric":"1",
                   "field":{
                      "_pair.second.Department":"(null)"
                   }
                }
             },
             {
                "group":{
                   "metric":"1",
                   "field":{
                      "_pair.second.Department":"CEO"
                   }
                }
             },
             {
                "group":{
                   "metric":"1",
                   "field":{
                      "_pair.second.Department":"STO"
                   }
                }
             },
             {
                "group":{
                   "metric":"2",
                   "field":{
                      "_pair.second.Department":"Support"
                   }
                }
             }
          ]
       }
    }

*** Request
    DELETE /_applications/Application/ApplicationKey
*** Response: 
    200 OK

